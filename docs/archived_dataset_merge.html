---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "archived_dataset_merge.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: archived_dataset_merge.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pubmed-Abstract/Fulltext-Fetching-Merging-and-Cleaning">Pubmed Abstract/Fulltext Fetching Merging and Cleaning<a class="anchor-link" href="#Pubmed-Abstract/Fulltext-Fetching-Merging-and-Cleaning"> </a></h2><p>Pubmed does not give fulltext/abstract text in a good format. It gives a CSV with the metadata of searched results. That means you have to use the Entrez fetch and then merge the abstracts and text information with the metadata to have something workable</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#     text = f.read()</span>
    
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;downloads/clin_study_meta.csv&quot;</span><span class="p">)</span>
<span class="n">records</span> <span class="o">=</span> <span class="n">get_pubmed_records</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">pmid</span><span class="p">)</span> <span class="k">for</span> <span class="n">pmid</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">]])</span>
<span class="nb">len</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="p">[</span><span class="s2">&quot;PubmedArticle&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">r</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span>

<span class="n">articles</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="s2">&quot;PubmedArticle&quot;</span><span class="p">]</span>

<span class="n">g</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;PMID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="s2">&quot;MedlineCitation.PMID&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">],</span>
    <span class="s2">&quot;BACKGROUND&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_segment</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">&quot;BACKGROUND&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">],</span>
    <span class="s2">&quot;OBJECTIVE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_segment</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">&quot;OBJECTIVE&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">],</span>
    <span class="s2">&quot;METHODS&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_segment</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">&quot;METHODS&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">],</span>
    <span class="s2">&quot;RESULTS&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_segment</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">&quot;RESULTS&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">],</span>
    <span class="s2">&quot;CONCLUSIONS&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">get_segment</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="s2">&quot;CONCLUSIONS&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">]</span>
<span class="p">}</span>


<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">dfx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;PMID&quot;</span><span class="p">)</span>
<span class="n">dfx</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;enriched_pm_10k.csv&quot;</span><span class="p">)</span>


<span class="c1">#dfx.head(), len(df), len(df2), df[:6768][&quot;PMID&quot;][0], df2[:6768][&quot;PMID&quot;][0]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(       PMID                                              Title  \
 0  28946522  The effect of manual therapy and exercise in p...   
 1  28325149  Low Dose Naltrexone in the Treatment of Fibrom...   
 2  29514165  High-Dose Erythropoietin for Asphyxia and Ence...   
 3  29424396  [Quality of sleep and academic performance in ...   
 4  29754671  Rationale and design for the Vascular Outcomes...   
 
                                              Authors  \
 0                 Ulger O, Demirel A, Oz M, Tamer S.   
 1  Metyas S, Chen CL, Yeter K, Solyman J, Arkfeld...   
 2  Juul SE, Comstock BA, Heagerty PJ, Mayock DE, ...   
 3  Bugueño M, Curihual C, Olivares P, Wallace J, ...   
 4  Capell WH, Bonaca MP, Nehler MR, Chen E, Kitte...   
 
                                             Citation First Author  \
 0  J Back Musculoskelet Rehabil. 2017 Nov 6;30(6)...      Ulger O   
 1  Curr Rheumatol Rev. 2018;14(2):177-180. doi: 1...     Metyas S   
 2  Neonatology. 2018;113(4):331-338. doi: 10.1159...      Juul SE   
 3  Rev Med Chil. 2017 Sep;145(9):1106-1114. doi: ...    Bugueño M   
 4  Am Heart J. 2018 May;199:83-91. doi: 10.1016/j...    Capell WH   
 
                    Journal/Book  Publication Year Create Date       PMCID  \
 0  J Back Musculoskelet Rehabil              2017  2017/09/27         NaN   
 1            Curr Rheumatol Rev              2018  2017/03/23         NaN   
 2                   Neonatology              2018  2018/03/08  PMC5980685   
 3                  Rev Med Chil              2017  2018/02/10         NaN   
 4                    Am Heart J              2018  2018/05/15         NaN   
 
       NIHMS ID                                DOI  \
 0          NaN                 10.3233/BMR-169673   
 1          NaN  10.2174/1573397113666170321120329   
 2  NIHMS937494                  10.1159/000486820   
 3          NaN    10.4067/s0034-98872017000901106   
 4          NaN          10.1016/j.ahj.2018.01.011   
 
                                           BACKGROUND  \
 0                                               None   
 1  ConclusionFibromyalgia is a chronic pain disor...   
 2                                               None   
 3  Sleeping and studying are the day-to-day activ...   
 4                                               None   
 
                                          CONCLUSIONS  \
 0  This study showed that SSE and manual therapy ...   
 1  This prospective study lends further support t...   
 2                                               None   
 3  A bad sleep quality influences academic perfor...   
 4                                               None   
 
                                              METHODS  \
 0  A total of one-hundred thirteen patients diagn...   
 1  Naltrexone is an opioid receptor antagonist us...   
 2                                               None   
 3  Students of the first and second year of high ...   
 4                                               None   
 
                                            OBJECTIVE  \
 0  To determine the effects of spinal stabilizati...   
 1  A significant number of fibromyalgia patients ...   
 2                                               None   
 3  To determine the quality of sleep and its rela...   
 4                                               None   
 
                                              RESULTS  
 0  Intragroup analyses both treatments were effec...  
 1  Two small prospective pilot studies have previ...  
 2                                               None  
 3  The interview was answered by 322 first year s...  
 4                                               None  ,
 10000,
 10000,
 28946522,
 28946522)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># def get_first(p):</span>
<span class="c1">#     return get(split_into_sentences(p), 0)</span>
<span class="c1"># #get(split_into_sentences(t), 0) for t in dfx[&quot;METHODS&quot;][:10] if split_into_sentences(t))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">,</span> <span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;DOI&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">])</span>
<span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;OBJECTIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;METHODS&quot;</span><span class="p">,</span> <span class="s2">&quot;RESULTS&quot;</span><span class="p">,</span> <span class="s2">&quot;CONCLUSIONS&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">dfx</span><span class="p">[</span><span class="n">dfx</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;None&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;paragraph&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfx</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">get_first</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pm_&quot;</span> <span class="o">+</span> <span class="n">tag</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">dfy</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    <span class="n">dfy</span> <span class="o">=</span> <span class="n">dfy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/ec2-user/anaconda3/envs/JupyterSystemEnv/lib/python3.6/site-packages/ipykernel_launcher.py:6: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  
/home/ec2-user/anaconda3/envs/JupyterSystemEnv/lib/python3.6/site-packages/ipykernel_launcher.py:7: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  import sys
/home/ec2-user/anaconda3/envs/JupyterSystemEnv/lib/python3.6/site-packages/ipykernel_launcher.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfy</span> <span class="o">=</span> <span class="n">dfy</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">])</span>
<span class="n">dfy</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfy</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;downloads/struct_abstracts_negatives_18k.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fetching-dataset-from-Google-Drive">Fetching dataset from Google Drive<a class="anchor-link" href="#Fetching-dataset-from-Google-Drive"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;https://drive.google.com/uc?export=download&amp;id=&#39;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;1t2m6IxieiE0hZ8TcLJe9foc7upngrA_0&quot;</span><span class="p">)</span>
<span class="n">df1</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; limitation|problem ... with ... l=be that&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;1t-2rU83KdppSrwDnqdQUi6Pvtw13D0bQ&quot;</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a ... drawback of&quot;</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;1iGdfLJ4MkTO8oOomFJ84JCc7nf2zYBul&quot;</span><span class="p">)</span>
<span class="n">df3</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a </span><span class="si">{negative_adjectives}</span><span class="s2"> ...  </span><span class="si">{problem_nouns}</span><span class="s2">&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df2</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(947, 1455, 18573)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
<span class="n">dff</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence_id</th>
      <th>title</th>
      <th>article_link</th>
      <th>sentence_text</th>
      <th>year</th>
      <th>mesh_list</th>
      <th>journal_title</th>
      <th>volume</th>
      <th>issue</th>
      <th>abstract</th>
      <th>source</th>
      <th>paragraph_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1263595</td>
      <td>Shoe-Integrated, Force Sensor Design for Conti...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/32545528/</td>
      <td>One problem with such methods is that they tap...</td>
      <td>2020</td>
      <td>['Biomechanical Phenomena', 'Body Weight', 'Eq...</td>
      <td>Sensors (Basel, Switzerland)</td>
      <td>20</td>
      <td>12</td>
      <td>Traditional pedobarography methods use direct ...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1821146</td>
      <td>The Problem with Gout Is That It's Still Such ...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/27481987/</td>
      <td>The Problem with Gout Is That It 's Still Such...</td>
      <td>2016</td>
      <td>['Allopurinol', 'therapeutic use', 'Arthritis,...</td>
      <td>The Journal of rheumatology</td>
      <td>43</td>
      <td>8</td>
      <td>NaN</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1840641</td>
      <td>Generation of noble-gas binding sites for crys...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/11752783/</td>
      <td>One problem with this approach is that not all...</td>
      <td>2002</td>
      <td>['Bacteriophage T4', 'enzymology', 'Binding Si...</td>
      <td>Acta crystallographica. Section D, Biological ...</td>
      <td>58</td>
      <td>Pt 1</td>
      <td>In recent years, the use of noble-gas complexe...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2187391</td>
      <td>Segmentation of Crohn, Lymphangiectasia, Xanth...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/22874169/</td>
      <td>However , a tough problem associated with this...</td>
      <td>2012</td>
      <td>['Algorithms', 'Artificial Intelligence', 'Cap...</td>
      <td>Studies in health technology and informatics</td>
      <td>180</td>
      <td>NaN</td>
      <td>Wireless capsule endoscopy (WCE) is a great br...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3202138</td>
      <td>Vection in virtual reality modulates vestibula...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/31233640/</td>
      <td>While significant technological advancements a...</td>
      <td>2019</td>
      <td>['Female', 'Humans', 'Male', 'Muscle, Skeletal...</td>
      <td>REFERENCES</td>
      <td>50</td>
      <td>10</td>
      <td>The popularity of virtual reality (VR) has inc...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[</span><span class="s2">&quot;article_link&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dff</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">])),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dff</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(20822, 20975)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PMID&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sentence_text&#39;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Title&quot;</span><span class="p">},</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentence_id</th>
      <th>Title</th>
      <th>article_link</th>
      <th>text</th>
      <th>year</th>
      <th>mesh_list</th>
      <th>journal_title</th>
      <th>volume</th>
      <th>issue</th>
      <th>abstract</th>
      <th>source</th>
      <th>paragraph_text</th>
      <th>PMID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1263595</td>
      <td>Shoe-Integrated, Force Sensor Design for Conti...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/32545528/</td>
      <td>One problem with such methods is that they tap...</td>
      <td>2020</td>
      <td>['Biomechanical Phenomena', 'Body Weight', 'Eq...</td>
      <td>Sensors (Basel, Switzerland)</td>
      <td>20</td>
      <td>12</td>
      <td>Traditional pedobarography methods use direct ...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
      <td>32545528</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1821146</td>
      <td>The Problem with Gout Is That It's Still Such ...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/27481987/</td>
      <td>The Problem with Gout Is That It 's Still Such...</td>
      <td>2016</td>
      <td>['Allopurinol', 'therapeutic use', 'Arthritis,...</td>
      <td>The Journal of rheumatology</td>
      <td>43</td>
      <td>8</td>
      <td>NaN</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
      <td>27481987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1840641</td>
      <td>Generation of noble-gas binding sites for crys...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/11752783/</td>
      <td>One problem with this approach is that not all...</td>
      <td>2002</td>
      <td>['Bacteriophage T4', 'enzymology', 'Binding Si...</td>
      <td>Acta crystallographica. Section D, Biological ...</td>
      <td>58</td>
      <td>Pt 1</td>
      <td>In recent years, the use of noble-gas complexe...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
      <td>11752783</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2187391</td>
      <td>Segmentation of Crohn, Lymphangiectasia, Xanth...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/22874169/</td>
      <td>However , a tough problem associated with this...</td>
      <td>2012</td>
      <td>['Algorithms', 'Artificial Intelligence', 'Cap...</td>
      <td>Studies in health technology and informatics</td>
      <td>180</td>
      <td>NaN</td>
      <td>Wireless capsule endoscopy (WCE) is a great br...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
      <td>22874169</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3202138</td>
      <td>Vection in virtual reality modulates vestibula...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/31233640/</td>
      <td>While significant technological advancements a...</td>
      <td>2019</td>
      <td>['Female', 'Humans', 'Male', 'Muscle, Skeletal...</td>
      <td>REFERENCES</td>
      <td>50</td>
      <td>10</td>
      <td>The popularity of virtual reality (VR) has inc...</td>
      <td>limitation|problem ... with ... l=be that</td>
      <td>NaN</td>
      <td>31233640</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>18568</th>
      <td>362702792</td>
      <td>Falls and injuries in frail and vigorous commu...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/1987256/</td>
      <td>These findings suggest that fall-related injur...</td>
      <td>1991</td>
      <td>['Accidental Falls', 'prevention &amp; control', '...</td>
      <td>Journal of the American Geriatrics Society</td>
      <td>39</td>
      <td>1</td>
      <td>Identification of different types of falls and...</td>
      <td>a {negative_adjectives} ...  {problem_nouns}</td>
      <td>NaN</td>
      <td>1987256</td>
    </tr>
    <tr>
      <th>18569</th>
      <td>362714838</td>
      <td>Intermittent catheterization: sterile or clean?</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/1989043/</td>
      <td>Bacteriuria -- asymptomatic and symptomatic --...</td>
      <td>1991</td>
      <td>['Bacteriuria', 'etiology', 'nursing', 'preven...</td>
      <td>Rehabilitation nursing : the official journal ...</td>
      <td>16</td>
      <td>1</td>
      <td>Bacteriuria--asymptomatic and symptomatic--alw...</td>
      <td>a {negative_adjectives} ...  {problem_nouns}</td>
      <td>NaN</td>
      <td>1989043</td>
    </tr>
    <tr>
      <th>18570</th>
      <td>362715256</td>
      <td>Variceal rebleeding after portosystemic shunti...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/1989102/</td>
      <td>Strategies and solutions to a vexing problem .</td>
      <td>1991</td>
      <td>['Combined Modality Therapy', 'Esophageal and ...</td>
      <td>The Surgical clinics of North America</td>
      <td>71</td>
      <td>1</td>
      <td>The purpose of this review was to discuss an a...</td>
      <td>a {negative_adjectives} ...  {problem_nouns}</td>
      <td>NaN</td>
      <td>1989102</td>
    </tr>
    <tr>
      <th>18571</th>
      <td>362724620</td>
      <td>Neuroprotective Effect of Natural Products on ...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/26645998/</td>
      <td>Peripheral nerve injury ( PNI ) is a serious p...</td>
      <td>2016</td>
      <td>['Animals', 'Biological Products', 'therapeuti...</td>
      <td>Neurochemical research</td>
      <td>41</td>
      <td>4</td>
      <td>Peripheral nerve injury (PNI) is a serious pub...</td>
      <td>a {negative_adjectives} ...  {problem_nouns}</td>
      <td>NaN</td>
      <td>26645998</td>
    </tr>
    <tr>
      <th>18572</th>
      <td>362750185</td>
      <td>Identification of Immunodominant Responses to ...</td>
      <td>https://pubmed.ncbi.nlm.nih.gov/26659715/</td>
      <td>Malaria , caused by the Plasmodium parasite , ...</td>
      <td>2015</td>
      <td>['Animals', 'Antigens, Protozoan', 'immunology...</td>
      <td>PloS one</td>
      <td>10</td>
      <td>12</td>
      <td>Malaria, caused by the Plasmodium parasite, re...</td>
      <td>a {negative_adjectives} ...  {problem_nouns}</td>
      <td>NaN</td>
      <td>26659715</td>
    </tr>
  </tbody>
</table>
<p>20822 rows × 13 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="p">[[</span><span class="s1">&#39;Title&#39;</span><span class="p">,</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s1">&#39;mesh_list&#39;</span><span class="p">,</span> <span class="s1">&#39;journal_title&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">,</span> <span class="s1">&#39;PMID&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dff</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/ec2-user/anaconda3/envs/python3/lib/python3.6/site-packages/ipykernel/__main__.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  if __name__ == &#39;__main__&#39;:
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df[&quot;PMID&quot;] = df[&quot;PMID&quot;].astype(str)</span>
<span class="c1"># df[&quot;labels&quot;] = df[&quot;labels&quot;].astype(str)</span>

<span class="c1"># df = df.dropna(subset=[&quot;text&quot;])</span>
<span class="c1"># df.to_csv(&quot;downloads/fat.csv&quot;, index=False)</span>

<span class="c1"># dfl = pd.read_csv(&quot;downloads/fat.csv&quot;)</span>
<span class="c1"># dft = pd.read_csv(&quot;downloads/struct_abstracts_negatives_18k.csv&quot;)</span>
<span class="c1"># dfall=dfl.append(dft)</span>
<span class="c1"># dfall[&quot;labels&quot;] = dfall[&quot;labels&quot;].astype(str)</span>

<span class="c1"># dfall = dfall.dropna(subset=[&quot;text&quot;])</span>


<span class="c1"># dfall = dfall[[&quot;PMID&quot;, &quot;Title&quot;, &quot;text&quot;, &quot;DOI&quot;, &quot;labels&quot;, &quot;source&quot;]]</span>
<span class="c1"># dfall.to_csv(&quot;downloads/40k_balanced_pm_acl.csv&quot;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

